{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'stream')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import 'crypto')"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/workspace/canteen-backend/src/middleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport jwt from 'jsonwebtoken';\n\nconst SECRET_KEY = 'super-secret-key-change-it'; // В реальном проекте храни в .env\n\nexport interface AuthRequest extends Request {\n  user?: { id: number; role: string };\n}\n\n// Проверка токена\nexport const verifyToken = (req: AuthRequest, res: Response, next: NextFunction) => {\n  const token = req.headers['authorization']?.split(' ')[1];\n  if (!token) return res.status(403).json({ message: 'No token provided' });\n\n  try {\n    const decoded = jwt.verify(token, SECRET_KEY) as any;\n    req.user = decoded;\n    next();\n  } catch (err) {\n    return res.status(401).json({ message: 'Unauthorized' });\n  }\n};\n\n// Проверка роли\nexport const checkRole = (roles: string[]) => {\n  return (req: AuthRequest, res: Response, next: NextFunction) => {\n    if (!req.user || !roles.includes(req.user.role)) {\n      return res.status(403).json({ message: 'Access denied' });\n    }\n    next();\n  };\n};\n\nexport { SECRET_KEY };"],"names":[],"mappings":";;;;;;;;AACA;;AAEA,MAAM,aAAa,8BAA8B,kCAAkC;AAO5E,MAAM,cAAc,CAAC,KAAkB,KAAe;IAC3D,MAAM,QAAQ,IAAI,OAAO,CAAC,gBAAgB,EAAE,MAAM,IAAI,CAAC,EAAE;IACzD,IAAI,CAAC,OAAO,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,SAAS;IAAoB;IAEvE,IAAI;QACF,MAAM,UAAU,2LAAG,CAAC,MAAM,CAAC,OAAO;QAClC,IAAI,IAAI,GAAG;QACX;IACF,EAAE,OAAO,KAAK;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAe;IACxD;AACF;AAGO,MAAM,YAAY,CAAC;IACxB,OAAO,CAAC,KAAkB,KAAe;QACvC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,MAAM,QAAQ,CAAC,IAAI,IAAI,CAAC,IAAI,GAAG;YAC/C,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAgB;QACzD;QACA;IACF;AACF"}}]
}